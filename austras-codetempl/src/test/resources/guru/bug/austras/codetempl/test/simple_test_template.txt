#PACKAGE#${TARGET.PACKAGE}#END#;

#IMPORTS#
guru.bug.austras.convert.converters.JsonConverter
guru.bug.austras.convert.json.reader.JsonValueReader
guru.bug.austras.convert.json.writer.JsonValueWriter
guru.bug.austras.core.Component
#END#

@Component
public class ${TARGET.SIMPLE_NAME}ToJsonConverter implements JsonConverter<${IMPORT:TARGET}> {

    #LOOP CNV : CONVERTERS#
    private ${IMPORT:CNV.TYPE} $CNV.NAME;
    #END#

    public FakeDtoToJsonConverter(#PARAMS CNV : CONVERTERS#${IMPORT:CNV.TYPE} ${CNV.NAME}#END#) {
        #LOOP CNV : CONVERTERS#
        this.${CNV.NAME} = ${CNV.NAME};
        #END#
    }

    @Override
    public void toJson(${IMPORT:TARGET} value, JsonValueWriter writer) {
        writer.writeObject(value, (obj, out) -> {
            #LOOP PROP : PROPERTIES#
            out.write("${PROP.NAME}", obj.${PROP.GETTER_NAME}(), ${PROP.CONVERTER.NAME};
            #END#
        });
    }

    @Override
    public ${IMPORT:TARGET} fromJson(JsonValueReader reader) {
        return reader.readObject(${IMPORT:TARGET}::new, (obj, key, in) -> {
            switch (key) {
                #LOOP PROP : PROPERTIES#
                case "${PROP.NAME}":
                    obj.${PROP.SETTER_NAME}(r.read(${PROP.CONVERTER.NAME}).orElse(null));
                    break;
                #END#
            }
        }).orElse(null);
    }
}
